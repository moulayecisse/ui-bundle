{# templates/components/Ui/collapsible-card.html.twig #}
{# Expandable/collapsible card component #}
{% props
    class = '',
    title = null,
    description = null,
    defaultExpanded = true,
    headerClass = 'w-full text-left',
    contentClass = ''
%}

{% set headerBlock %}{% block header '' %}{% endset %}
{% set actionsBlock %}{% block actions '' %}{% endset %}
{% set hasCustomHeader = headerBlock is not empty %}

{% set class = (class)|tailwind_merge %}

<div
    {{ attributes }}
    data-controller="cisse--ui-bundle--collapsible-card"
    data-cisse--ui-bundle--collapsible-card-expanded-value="{{ defaultExpanded ? 'true' : 'false' }}"
    class="{{ class }}"
>
    <twig:Ui:card>
        {% if hasCustomHeader %}
            {# Custom header mode #}
            {% block card_header %}
                <button
                    type="button"
                    data-action="click->cisse--ui-bundle--collapsible-card#toggle"
                    class="{{ headerClass }}"
                >
                    {{ headerBlock|raw }}
                </button>
            {% endblock %}
        {% else %}
            {# Standard mode: title/description with toggle button #}
            {% block card_title %}
                <twig:Ui:card:header>
                    <div class="flex items-center justify-between w-full">
                        <div>
                            {% if title %}
                                <twig:Ui:card:title>{{ title }}</twig:Ui:card:title>
                            {% endif %}
                            {% if description %}
                                <twig:Ui:card:description>{{ description }}</twig:Ui:card:description>
                            {% endif %}
                        </div>
                        <div class="flex items-center gap-2">
                            {{ actionsBlock|raw }}
                            <button
                                type="button"
                                data-action="click->cisse--ui-bundle--collapsible-card#toggle"
                                class="rounded-lg p-1.5 text-gray-500 hover:bg-gray-100 dark:text-gray-400 dark:hover:bg-gray-800"
                            >
                                <twig:ux:icon
                                    data-cisse--ui-bundle--collapsible-card-target="icon"
                                    name="{{ defaultExpanded ? 'heroicons:chevron-up-20-solid' : 'heroicons:chevron-down-20-solid' }}"
                                    class="size-5 transition-transform duration-200"
                                />
                            </button>
                        </div>
                    </div>
                </twig:Ui:card:header>
            {% endblock %}
        {% endif %}

        {# Collapsible content #}
        <div
            data-cisse--ui-bundle--collapsible-card-target="content"
            class="overflow-hidden transition-all duration-200 ease-out {{ contentClass }}"
            style="{{ defaultExpanded ? '' : 'max-height: 0; opacity: 0;' }}"
        >
            <twig:Ui:card:content>
                {% block content '' %}
            </twig:Ui:card:content>
        </div>
    </twig:Ui:card>
</div>
