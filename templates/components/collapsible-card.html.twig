{# templates/components/Ui/collapsible-card.html.twig #}
{# Expandable/collapsible card component #}
{% props
    class = '',
    title = null,
    description = null,
    defaultExpanded = true,
    headerClass = 'w-full text-left',
    contentClass = ''
%}

{% set headerBlock %}{% block header '' %}{% endset %}
{% set actionsBlock %}{% block actions '' %}{% endset %}
{% set hasCustomHeader = headerBlock is not empty %}

{% set class = (class)|tailwind_merge %}

<div
    {{ attributes }}
    data-controller="cisse--ui-bundle--collapsible-card"
    data-cisse--ui-bundle--collapsible-card-expanded-value="{{ defaultExpanded ? 'true' : 'false' }}"
    class="{{ class }}"
>
    <twig:Ui:card>
        {# Header - custom or standard mode rendered inline #}
        <twig:Ui:card:header>
            <div class="flex items-center justify-between w-full">
                <div>
                    {% if hasCustomHeader %}
                        {{ headerBlock|raw }}
                    {% else %}
                        {% if title %}
                            <h3 class="text-base font-semibold text-gray-800 dark:text-white/90">{{ title }}</h3>
                        {% endif %}
                        {% if description %}
                            <p class="mt-1 text-sm text-gray-500 dark:text-gray-400">{{ description }}</p>
                        {% endif %}
                    {% endif %}
                </div>
                <div class="flex items-center gap-2">
                    {{ actionsBlock|raw }}
                    <button
                        type="button"
                        data-action="click->cisse--ui-bundle--collapsible-card#toggle"
                        class="rounded-lg p-1.5 text-gray-500 hover:bg-gray-100 dark:text-gray-400 dark:hover:bg-gray-800"
                    >
                        <twig:ux:icon
                            data-cisse--ui-bundle--collapsible-card-target="icon"
                            name="{{ defaultExpanded ? 'heroicons:chevron-up-20-solid' : 'heroicons:chevron-down-20-solid' }}"
                            class="size-5 transition-transform duration-200"
                        />
                    </button>
                </div>
            </div>
        </twig:Ui:card:header>

        {# Collapsible content #}
        <div
            data-cisse--ui-bundle--collapsible-card-target="content"
            class="overflow-hidden transition-all duration-200 ease-out {{ contentClass }}"
            style="{{ defaultExpanded ? '' : 'max-height: 0; opacity: 0;' }}"
        >
            <twig:Ui:card:content>
                {% block content '' %}
            </twig:Ui:card:content>
        </div>
    </twig:Ui:card>
</div>
