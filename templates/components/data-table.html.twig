{% props
  fields = [],
  items = [],
  hideHeader = false,
  hideFooter = false,
  size = 'default',
  variant = 'default',
  striped = false,
  hover = true,
  emptyMessage = 'No results found',
  responsive = true,
  class = '',
%}

<twig:ui:table :class="class" :size="size" :variant="variant" :striped="striped" :hover="hover" :responsive="responsive" :attributes="attributes">
  {% if not hideHeader %}
    <twig:ui:thead {{ ...attributes.nested('thead') }}>
      <twig:ui:tr>
        {% for field in fields %}
          {% set block_content %}
            {% set block_name = 'thead_' ~ (field.name ?? field) %}
            {% if block(block_name) is defined %}
              {{ block(block_name) }}
            {% else %}
              {{ attribute(field, 'label') ?? attribute(field, 'name') ?? field ?? '' }}
            {% endif %}
          {% endset %}

          <twig:ui:th>
            {{ block_content|raw }}
          </twig:ui:th>
        {% endfor %}
      </twig:ui:tr>
    </twig:ui:thead>
  {% endif %}

  <twig:ui:tbody {{ ...attributes.nested('tbody') }}>
    {% for item in items %}
      <twig:ui:tr>
        {% for field in fields %}
          {% set block_content %}
            {% set loop_block_name = 'tbody_' ~ (field.name ?? field) ~ '_' ~ loop.index0 %}
            {% set block_name = 'tbody_' ~ (field.name ?? field) %}

            {% if block(loop_block_name) is defined %}
              {{ block(loop_block_name) }}
            {% elseif block(block_name) is defined %}
              {{ block(block_name) }}
            {% else %}
              {{ attribute(item, field.name ?? field) ?? '' }}
            {% endif %}
          {% endset %}

          <twig:ui:td>
            {{ block_content }}
          </twig:ui:td>
        {% endfor %}
      </twig:ui:tr>
    {% else %}
      <twig:ui:tr>
        <twig:ui:td colspan="{{ fields|length }}" class="text-center text-gray-500 dark:text-gray-400 py-8">{{ emptyMessage }}</twig:ui:td>
      </twig:ui:tr>
    {% endfor %}
  </twig:ui:tbody>

  {% if hideFooter %}
    <twig:ui:tfoot {{ ...attributes.nested('tbody') }}>
      <twig:ui:tr>
        {% for field in fields %}
          <twig:ui:th>{{ field }}</twig:ui:th>
        {% endfor %}
      </twig:ui:tr>
    </twig:ui:tfoot>
  {% endif %}
</twig:ui:table>
