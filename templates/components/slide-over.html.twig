{# templates/components/Ui/slide-over.html.twig #}
{% props
    title = '',
    description = '',
    position = 'right',
    size = 'default',
    closeOnBackdrop = true,
    closeOnEscape = true,
    open = false,
    hideCloseButton = false,
    showHeader = true,
    variant = 'default',
    class = ''
%}

{# Nested attributes for fine-grained customization #}
{% set triggerAttrs = attributes.nested('trigger') %}
{% set backdropAttrs = attributes.nested('backdrop') %}
{% set panelAttrs = attributes.nested('panel') %}
{% set headerAttrs = attributes.nested('header') %}
{% set titleAttrs = attributes.nested('title') %}
{% set descriptionAttrs = attributes.nested('description') %}
{% set closeAttrs = attributes.nested('close') %}
{% set contentAttrs = attributes.nested('content') %}
{% set footerAttrs = attributes.nested('footer') %}

<div
        {{ attributes }}
        data-controller="cisse--ui-bundle--slide-over"
        data-cisse--ui-bundle--slide-over-close-on-backdrop-value="{{ closeOnBackdrop ? 'true' : 'false' }}"
        data-cisse--ui-bundle--slide-over-close-on-escape-value="{{ closeOnEscape ? 'true' : 'false' }}"
        data-cisse--ui-bundle--slide-over-open-value="{{ open ? 'true' : 'false' }}"
        data-cisse--ui-bundle--slide-over-position-value="{{ position }}"
        data-cisse--ui-bundle--slide-over-size-value="{{ size }}"
>
    <!-- Trigger -->
    <div data-action="click->cisse--ui-bundle--slide-over#toggle" class="{{ triggerAttrs.render('class')|tailwind_merge }}" {{ triggerAttrs.without('class') }}>
        {% block trigger %}
            <button class="px-4 py-3 text-sm font-medium text-white rounded-lg bg-primary-500 shadow-theme-xs hover:bg-primary-600 transition-colors">
                Open Slide-over
            </button>
        {% endblock %}
    </div>

    <!-- Slide-over -->
    <div
            data-cisse--ui-bundle--slide-over-target="slideOver"
            class="relative z-50 {{ class }}"
            aria-labelledby="slide-over-title"
            role="dialog"
            aria-modal="true"
            aria-hidden="true"
            style="display: none;"
    >
        <!-- Backdrop -->
        <div
                data-cisse--ui-bundle--slide-over-target="backdrop"
                class="{{ ('fixed inset-0 bg-black/50 ' ~ backdropAttrs.render('class'))|tailwind_merge }}"
                {{ backdropAttrs.without('class') }}
                aria-hidden="true"
        ></div>

        <!-- Panel Container -->
        <div class="fixed inset-0 overflow-hidden">
            <div class="absolute inset-0 overflow-hidden">
                <div 
                        data-position="{{ position }}"
                        class="pointer-events-none fixed inset-y-0 right-0 pl-10 sm:pl-16 data-[position=left]:inset-y-0 data-[position=left]:left-0 data-[position=left]:pr-10 sm:data-[position=left]:pr-16 data-[position=left]:pl-0 data-[position=top]:inset-x-0 data-[position=top]:top-0 data-[position=top]:pb-10 sm:data-[position=top]:pb-16 data-[position=top]:pl-0 data-[position=bottom]:inset-x-0 data-[position=bottom]:bottom-0 data-[position=bottom]:pt-10 sm:data-[position=bottom]:pt-16 data-[position=bottom]:pl-0 flex max-w-full">
                    <!-- Panel -->
                    <div
                            data-cisse--ui-bundle--slide-over-target="panel"
                            data-size="{{ size }}"
                            class="{{ ('pointer-events-auto w-screen max-w-2xl data-[size=sm]:max-w-md data-[size=lg]:max-w-4xl data-[size=xl]:max-w-6xl data-[size=full]:max-w-full ' ~ panelAttrs.render('class'))|tailwind_merge }}"
                            {{ panelAttrs.without('class') }}
                    >
                        {% set variantClasses = {
                            'default': 'bg-white dark:bg-gray-900',
                            'dark': 'bg-gray-900 dark:bg-gray-950 text-white',
                            'transparent': 'bg-white/95 dark:bg-gray-900/95 backdrop-blur-sm',
                        } %}
                        <div class="flex h-full flex-col ui-scrollbar overflow-y-scroll {{ variantClasses[variant] ?? variantClasses['default'] }} shadow-xl">
                            <!-- Header -->
                            {% if showHeader and (title or description) %}
                                <div class="{{ ('flex items-center justify-between px-4 py-3 border-b border-gray-200 dark:border-gray-700 ' ~ headerAttrs.render('class'))|tailwind_merge }}" {{ headerAttrs.without('class') }}>
                                    <div>
                                        {% if title %}
                                            <h2 class="{{ ('text-lg font-semibold ' ~ (variant == 'dark' ? 'text-white' : 'text-gray-900 dark:text-white') ~ ' ' ~ titleAttrs.render('class'))|tailwind_merge }}" {{ titleAttrs.without('class') }} id="slide-over-title">
                                                {{ title }}
                                            </h2>
                                        {% endif %}
                                        {% if description %}
                                            <p class="{{ ('mt-1 text-sm ' ~ (variant == 'dark' ? 'text-gray-400' : 'text-gray-500 dark:text-gray-400') ~ ' ' ~ descriptionAttrs.render('class'))|tailwind_merge }}" {{ descriptionAttrs.without('class') }}>{{ description }}</p>
                                        {% endif %}
                                    </div>
                                    {% if not hideCloseButton %}
                                        <button
                                            data-cisse--ui-bundle--slide-over-target="closeButton"
                                            data-action="click->cisse--ui-bundle--slide-over#close"
                                            type="button"
                                            class="{{ ('p-1 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 ' ~ (variant == 'dark' ? 'text-gray-400 hover:text-white' : 'text-gray-400 hover:text-gray-600 dark:hover:text-gray-300') ~ ' ' ~ closeAttrs.render('class'))|tailwind_merge }}"
                                            {{ closeAttrs.without('class') }}
                                            aria-label="Close slide-over"
                                        >
                                            <twig:ux:icon name="heroicons:x-mark" class="size-5" />
                                        </button>
                                    {% endif %}
                                </div>
                            {% endif %}

                            <!-- Content -->
                            <div class="{{ ('flex-1 ui-scrollbar overflow-y-auto p-4 ' ~ contentAttrs.render('class'))|tailwind_merge }}" {{ contentAttrs.without('class') }}>
                                {% block content '' %}
                            </div>

                            <!-- Footer -->
                            {% set footerBlock %}{% block footer '' %}{% endset %}
                            {% if footerBlock is not empty %}
                                <div class="{{ ('shrink-0 border-t border-gray-200 dark:border-gray-800 px-4 py-5 sm:px-6 ' ~ footerAttrs.render('class'))|tailwind_merge }}" {{ footerAttrs.without('class') }}>
                                    {{ footerBlock|raw }}
                                </div>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>