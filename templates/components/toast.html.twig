{% props
    message = '',
    type = 'info',
    title = null,
    closable = true,
    duration = 5000,
    icon = null,
    showIcon = true,
    variant = 'default',
    position = null,
    actionLabel = null,
    actionUrl = null,
    class = '',
%}

{% set typeConfig = {
    'success': { icon: 'lucide:check-circle', bg: 'bg-green-50 border-green-200 dark:bg-green-950 dark:border-green-800', iconColor: 'text-green-500', actionColor: 'text-green-600 hover:text-green-700' },
    'error': { icon: 'lucide:x-circle', bg: 'bg-red-50 border-red-200 dark:bg-red-950 dark:border-red-800', iconColor: 'text-red-500', actionColor: 'text-red-600 hover:text-red-700' },
    'warning': { icon: 'lucide:alert-triangle', bg: 'bg-yellow-50 border-yellow-200 dark:bg-yellow-950 dark:border-yellow-800', iconColor: 'text-yellow-500', actionColor: 'text-yellow-600 hover:text-yellow-700' },
    'info': { icon: 'lucide:info', bg: 'bg-blue-50 border-blue-200 dark:bg-blue-950 dark:border-blue-800', iconColor: 'text-blue-500', actionColor: 'text-blue-600 hover:text-blue-700' },
    'default': { icon: 'lucide:bell', bg: 'bg-white border-gray-200 dark:bg-gray-900 dark:border-gray-700', iconColor: 'text-gray-500', actionColor: 'text-primary hover:text-primary/80' },
} %}

{% set config = typeConfig[type] ?? typeConfig['info'] %}
{% set iconName = icon ?? config.icon %}

{# Variant classes #}
{% set variantClasses = {
    'default': config.bg,
    'solid': 'bg-' ~ type ~ '-500 border-' ~ type ~ '-500 text-white',
    'minimal': 'bg-white dark:bg-gray-900 border-gray-200 dark:border-gray-700',
} %}

{% set bgClass = variantClasses[variant] ?? variantClasses['default'] %}

{% set actionBlock %}{% block action '' %}{% endset %}
{% set hasAction = actionBlock|trim or actionLabel %}

<div
    {{ attributes }}
    data-controller="cisse--ui-bundle--toast"
    data-cisse--ui-bundle--toast-duration-value="{{ duration }}"
    data-type="{{ type }}"
    data-variant="{{ variant }}"
    {% if position %}data-position="{{ position }}"{% endif %}
    class="{{ ('flex items-start gap-3 rounded-lg border p-4 shadow-lg ' ~ bgClass ~ ' ' ~ class)|tailwind_merge }}"
    role="alert"
>
    {# Icon #}
    {% if showIcon %}
        <twig:ux:icon
            :name="iconName"
            class="size-5 shrink-0 {{ variant == 'solid' ? 'text-white' : config.iconColor }}"
            aria-hidden="true"
        />
    {% endif %}

    {# Content #}
    <div class="flex-1 min-w-0">
        {% if title %}
            <p class="font-medium {{ variant == 'solid' ? 'text-white' : 'text-gray-900 dark:text-white' }}">
                {% block title %}{{ title }}{% endblock %}
            </p>
        {% endif %}
        <p class="text-sm {{ variant == 'solid' ? 'text-white/90' : 'text-gray-700 dark:text-gray-300' }}">
            {% block message %}{{ message }}{% endblock %}
        </p>

        {# Action buttons #}
        {% if hasAction %}
            <div class="mt-3 flex items-center gap-3">
                {% if actionBlock|trim %}
                    {{ actionBlock|raw }}
                {% endif %}

                {% if actionLabel %}
                    <a
                        href="{{ actionUrl ?? '#' }}"
                        class="text-sm font-medium {{ variant == 'solid' ? 'text-white underline hover:no-underline' : config.actionColor }}"
                    >
                        {{ actionLabel }}
                    </a>
                {% endif %}
            </div>
        {% endif %}
    </div>

    {# Close button #}
    {% if closable %}
        <button
            type="button"
            class="shrink-0 rounded p-1 {{ variant == 'solid' ? 'text-white/70 hover:text-white hover:bg-white/10' : 'text-gray-400 hover:bg-gray-200 hover:text-gray-600 dark:hover:bg-gray-700 dark:hover:text-gray-300' }}"
            aria-label="Dismiss notification"
            data-action="click->cisse--ui-bundle--toast#close"
        >
            <twig:ux:icon name="lucide:x" class="size-4" aria-hidden="true" />
        </button>
    {% endif %}
</div>
