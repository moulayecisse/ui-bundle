{% props
  name = null,
  id = null,
  value = null,
  placeholder = '0',
  size = 'md',
  disabled = false,
  min = null,
  max = null,
  step = 1,
  showStepper = true,
  required = false,
  class = '',
%}

{% set sizeClasses = {
  'sm': { 'wrapper': 'h-8 px-2 gap-2', 'icon': 'size-4', 'input': 'text-sm' },
  'md': { 'wrapper': 'h-10 px-3 gap-2', 'icon': 'size-5', 'input': 'text-base' },
  'lg': { 'wrapper': 'h-12 px-4 gap-3', 'icon': 'size-6', 'input': 'text-lg' },
} %}

{% set currentSize = sizeClasses[size] ?? sizeClasses['md'] %}

<div
  {{ attributes }}
  data-controller="cisse--ui-bundle--number-input"
  data-cisse--ui-bundle--number-input-min-value="{{ min ?? '' }}"
  data-cisse--ui-bundle--number-input-max-value="{{ max ?? '' }}"
  data-cisse--ui-bundle--number-input-step-value="{{ step }}"
  class="{{ ('flex items-center rounded-lg border border-gray-300 bg-white focus-within:ring-2 focus-within:ring-primary-500 focus-within:border-transparent dark:border-gray-600 dark:bg-gray-800 ' ~ currentSize.wrapper ~ ' ' ~ (disabled ? 'bg-gray-100 dark:bg-gray-900 cursor-not-allowed opacity-60' : '') ~ ' ' ~ class)|tailwind_merge }}"
>
  {# Decrement button #}
  {% if showStepper %}
    <button
      type="button"
      data-cisse--ui-bundle--number-input-target="decrement"
      data-action="click->cisse--ui-bundle--number-input#decrement"
      class="p-1 rounded hover:bg-gray-100 dark:hover:bg-slate-600 transition-colors disabled:opacity-30 disabled:cursor-not-allowed shrink-0"
      {{ disabled ? 'disabled' }}
    >
      <twig:ux:icon name="heroicons:minus" class="{{ currentSize.icon }} text-gray-500" />
    </button>
  {% endif %}

  {# Input #}
  <input
    data-cisse--ui-bundle--number-input-target="input"
    type="number"
    {% if name %}name="{{ name }}"{% endif %}
    {% if id %}id="{{ id }}"{% elseif name %}id="{{ name }}"{% endif %}
    value="{{ value }}"
    placeholder="{{ placeholder }}"
    {{ disabled ? 'disabled' }}
    {{ required ? 'required' }}
    {% if min is not null %}min="{{ min }}"{% endif %}
    {% if max is not null %}max="{{ max }}"{% endif %}
    step="{{ step }}"
    class="flex-1 bg-transparent border-none focus:outline-none text-gray-800 dark:text-gray-200 placeholder-gray-400 dark:placeholder-gray-500 text-center {{ currentSize.input }} {{ showStepper ? 'px-2' : '' }}"
    data-action="input->cisse--ui-bundle--number-input#handleInput"
  >

  {# Increment button #}
  {% if showStepper %}
    <button
      type="button"
      data-cisse--ui-bundle--number-input-target="increment"
      data-action="click->cisse--ui-bundle--number-input#increment"
      class="p-1 rounded hover:bg-gray-100 dark:hover:bg-slate-600 transition-colors disabled:opacity-30 disabled:cursor-not-allowed shrink-0"
      {{ disabled ? 'disabled' }}
    >
      <twig:ux:icon name="heroicons:plus" class="{{ currentSize.icon }} text-gray-500" />
    </button>
  {% endif %}
</div>
