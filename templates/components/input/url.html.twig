{% props
  name = null,
  id = null,
  value = '',
  placeholder = 'https://example.com',
  size = 'md',
  disabled = false,
  showValidation = true,
  required = false,
  class = '',
%}

{% set sizeClasses = {
  'sm': { 'wrapper': 'h-8 px-2 gap-2', 'icon': 'size-4', 'input': 'text-sm' },
  'md': { 'wrapper': 'h-10 px-3 gap-2', 'icon': 'size-5', 'input': 'text-base' },
  'lg': { 'wrapper': 'h-12 px-4 gap-3', 'icon': 'size-6', 'input': 'text-lg' },
} %}

{% set currentSize = sizeClasses[size] ?? sizeClasses['md'] %}

<div
  {{ attributes }}
  data-controller="cisse--ui-bundle--url-input"
  data-cisse--ui-bundle--url-input-show-validation-value="{{ showValidation ? 'true' : 'false' }}"
  class="{{ ('flex items-center rounded-lg border border-gray-300 bg-white focus-within:ring-2 focus-within:ring-primary-500 focus-within:border-transparent dark:border-gray-600 dark:bg-gray-800 ' ~ currentSize.wrapper ~ ' ' ~ (disabled ? 'bg-gray-100 dark:bg-gray-900 cursor-not-allowed opacity-60' : '') ~ ' ' ~ class)|tailwind_merge }}"
>
  {# Icon #}
  <twig:ux:icon name="heroicons:link" class="{{ currentSize.icon }} text-gray-400 shrink-0" />

  {# Input #}
  <input
    data-cisse--ui-bundle--url-input-target="input"
    type="url"
    {% if name %}name="{{ name }}"{% endif %}
    {% if id %}id="{{ id }}"{% elseif name %}id="{{ name }}"{% endif %}
    value="{{ value }}"
    placeholder="{{ placeholder }}"
    {{ disabled ? 'disabled' }}
    {{ required ? 'required' }}
    class="flex-1 bg-transparent border-none focus:outline-none text-gray-800 dark:text-gray-200 placeholder-gray-400 dark:placeholder-gray-500 {{ currentSize.input }}"
    data-action="blur->cisse--ui-bundle--url-input#handleBlur input->cisse--ui-bundle--url-input#handleInput"
  >

  {# Action buttons #}
  <div data-cisse--ui-bundle--url-input-target="actions" class="shrink-0 flex items-center gap-1">
    {# Open URL button #}
    <button
      type="button"
      data-cisse--ui-bundle--url-input-target="openButton"
      data-action="click->cisse--ui-bundle--url-input#openUrl"
      class="p-1 rounded hover:bg-gray-100 dark:hover:bg-gray-600 transition-colors hidden"
      title="Open URL"
    >
      <twig:ux:icon name="heroicons:arrow-top-right-on-square" class="size-4 text-gray-400 hover:text-primary-500" />
    </button>

    {# Invalid icon #}
    <twig:ux:icon name="heroicons:exclamation-circle" data-cisse--ui-bundle--url-input-target="invalidIcon" class="size-5 text-red-500 hidden" />
  </div>
</div>
