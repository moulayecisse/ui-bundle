{% props
  name = null,
  id = null,
  value = 1,
  size = 'md',
  disabled = false,
  min = 1,
  max = null,
  step = 1,
  required = false,
  class = '',
%}

{% set sizeClasses = {
  'sm': { 'button': 'size-7', 'icon': 'size-3', 'input': 'text-sm w-10' },
  'md': { 'button': 'size-9', 'icon': 'size-4', 'input': 'text-base w-12' },
  'lg': { 'button': 'size-11', 'icon': 'size-5', 'input': 'text-lg w-14' },
} %}

{% set currentSize = sizeClasses[size] ?? sizeClasses['md'] %}

<div
  {{ attributes }}
  data-controller="cisse--ui-bundle--quantity-input"
  data-cisse--ui-bundle--quantity-input-min-value="{{ min ?? '' }}"
  data-cisse--ui-bundle--quantity-input-max-value="{{ max ?? '' }}"
  data-cisse--ui-bundle--quantity-input-step-value="{{ step }}"
  class="{{ ('inline-flex items-center gap-2 bg-gray-50 dark:bg-slate-700 rounded-xl p-1 border border-gray-200 dark:border-slate-600 ' ~ class)|tailwind_merge }}"
>
  {# Decrement button #}
  <button
    type="button"
    data-cisse--ui-bundle--quantity-input-target="decrement"
    data-action="click->cisse--ui-bundle--quantity-input#decrement"
    class="flex items-center justify-center rounded-lg bg-white dark:bg-slate-600 border border-gray-200 dark:border-slate-500 transition-all hover:bg-gray-50 dark:hover:bg-slate-500 hover:border-gray-300 dark:hover:border-slate-400 disabled:opacity-40 disabled:cursor-not-allowed disabled:hover:bg-white dark:disabled:hover:bg-slate-600 shadow-sm {{ currentSize.button }}"
    {{ disabled ? 'disabled' }}
  >
    <twig:ux:icon name="heroicons:minus" class="text-gray-600 dark:text-gray-300 {{ currentSize.icon }}" />
  </button>

  {# Value display #}
  <input
    data-cisse--ui-bundle--quantity-input-target="input"
    type="number"
    {% if name %}name="{{ name }}"{% endif %}
    {% if id %}id="{{ id }}"{% elseif name %}id="{{ name }}"{% endif %}
    value="{{ value }}"
    {{ disabled ? 'disabled' }}
    {{ required ? 'required' }}
    {% if min is not null %}min="{{ min }}"{% endif %}
    {% if max is not null %}max="{{ max }}"{% endif %}
    class="bg-transparent text-center font-semibold text-gray-900 dark:text-white focus:outline-none appearance-none disabled:opacity-50 {{ currentSize.input }}"
    style="-moz-appearance: textfield;"
    data-action="input->cisse--ui-bundle--quantity-input#handleInput"
  >

  {# Increment button #}
  <button
    type="button"
    data-cisse--ui-bundle--quantity-input-target="increment"
    data-action="click->cisse--ui-bundle--quantity-input#increment"
    class="flex items-center justify-center rounded-lg bg-white dark:bg-slate-600 border border-gray-200 dark:border-slate-500 transition-all hover:bg-gray-50 dark:hover:bg-slate-500 hover:border-gray-300 dark:hover:border-slate-400 disabled:opacity-40 disabled:cursor-not-allowed disabled:hover:bg-white dark:disabled:hover:bg-slate-600 shadow-sm {{ currentSize.button }}"
    {{ disabled ? 'disabled' }}
  >
    <twig:ux:icon name="heroicons:plus" class="text-gray-600 dark:text-gray-300 {{ currentSize.icon }}" />
  </button>
</div>

<style>
/* Hide number input spinners */
input[type="number"]::-webkit-inner-spin-button,
input[type="number"]::-webkit-outer-spin-button {
  -webkit-appearance: none;
  margin: 0;
}
</style>
